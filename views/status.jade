doctype
html
  head
    title= title
    link(rel='stylesheet', href='/stylesheets/main.css')
    link(rel='stylesheet', href='/stylesheets/grid.css')
    link(href="https://fonts.googleapis.com/css?family=Roboto+Slab" rel="stylesheet")

  body

    div.banner
      h1.gum#random oh aauugghh ooohhh
    div.content
      div.wrapper#jstree
        h1.subgum Just a moment...

  footer
    script(src="https://platform.twitter.com/widgets.js")
    script(src='https://cdn.jsdelivr.net/npm/moment@2.18.1/min/moment.min.js')
    script(src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.1/jquery.min.js")
    script(src='https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js')

    script(src='javascripts/palette.js')
    script(src='javascripts/gridDisplay.js')
    script.

      var phrases = [
        "oaaguguhh ooohh",
        "bigger than a breadbox",
        "bigfoot juice sold here",
        "door juice sold here",
        "when u cant fit thru the door",
        "itachi robot",
        "welcome to fart town",
        "cockroach defense lawyer",
        "hey guys whats going on",
        "goo tube",
        "hot dog",
        "got hod....",
        "got milk?",
        "I have three tankers full of milk right around the corner. I am prepared to make a deal with you right here right now. I am looking to convert all of this liquid capital I have into solid capital."
      ]

      function setRandom(from) {
        document.getElementById('random').textContent = from[Math.floor(Math.random() * from.length)];
      }

      function getCache() {
        var xhr = new XMLHttpRequest();
        xhr.open('GET', "/status", true);
        xhr.send();
         
        xhr.onreadystatechange = processRequest;
         
        function processRequest(e) {
          if (xhr.readyState == 4 && xhr.status == 200) {
            jsonDisplay(document.getElementById('jstree'), JSON.parse(xhr.response));
          };
        };
      };

      setRandom(phrases)

      var cache = ('#{currentCache}');
      cache = cache.replace(/(&quot;)+/g, '"');
      cache = JSON.parse(cache);
      jsonDisplay(document.getElementById('jstree'), cache);
      setInterval(getCache, 5 * 1000);


